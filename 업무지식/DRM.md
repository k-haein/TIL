
# DRM


### <b>D</b>igital <b>R</b>ight <b>M</b>anagement(디지털 권리 관리)
<br>

```
문서 보안 프로그램
ex) 일정 시간동안만 접근 가능, 특정 인물 권한 제한 등
```

출판자 또는 저작권자가 그들이 배포한 디지털 자료나 하드웨어의 사용을 제어하고 의도한 용도로만 사용하도록 제한하는 모든 기술 통칭. 보통 기밀 사항 등의 내부 문서를 유출되지 않도록 관리하는데 사용한다. 

인증된 사용자가 인증된 기간동안만 사용가능하도록 통제.

기본 로직은 원본+사용규칙이 합해져서 보호된 컨텐츠로 나오고, 이를 배포하면 사용자가 라이선스 인증 후 복호화를 풀어서 사용 가능하다.

------------------------

우리 솔루션은 Excel 다운로드로 대표되는 문서 보안과 관련이 있다.

<img src="https://t1.daumcdn.net/cfile/tistory/994916335A050D4131"/>

<i style="font-size : 10px">출처 : https://limkydev.tistory.com/132</i>

대표적으로 DRM 관련 문의는 그리드의 내용을 엑셀다운로드/업로드 시 보안을 위해 DRM 서비스를 추가하고 싶다는 내용이 있다.

이 경우 그림과 같이 콘텐츠를 생산/업로드 할 때 암호화 사용 규칙을 포함해 보호된 콘텐츠를 만들고, 서버에서 이를 꺼낼 때마다 라이선스 정보로 이를 인증해야만 해석된 콘텐츠를 받아볼 수 있다.

<b>따라서 사용자는 단말기에 DRM 암호를 풀 수 있는 복호화 모듈을 설치해야 한다.</b>

라이선스 정보에는 콘텐츠를 복호화를 할 수 있는 키 정보와 사용 제약 조건 등이 포함되어있다. 이를 이용하여 복호화 모듈을 거쳐 원본 콘텐츠를 확인할 수 있다.

----------------------
우리 솔루션의 경우, 엑셀 다운로드/업로드 처리는 다음과 같다.

[클라이언트모듈]
- IE10 이상의 브라우저에서 바로 다운로드/업로드 가능
- 다운로드 받을 데이터의 갯수가 많아지면 다운로드 속도가 느려진다.
- 파일 업로드 시 DRM 해제 불가


[서버모듈]
- 엑셀 다운로드 : 화면단의 데이터를 서버로 전송하여 서버에서 엑셀 파일을 만들어서 다운로드 하는 형태로 동작
- 엑셀 업로드 : 서버로 파일을 전송하여 서버에서 파일을 읽은 후 데이터를 다시 브라우저로 보내는 형태로 동작
- 오픈소스 poi을 사용하므로 poi 라이브러리와 서버모듈이 WEB-INF/lib 안에 존재해야 함.

<br><br>

AxtiveX 제품에서는 클라이언트 PC에서 엑셀파일을 바로 읽어 표시할 수 있었다. 하지만 JavaScript 제품에서는 클라이언트에서 읽을 수 없어서 이를 서버에서 처리해주어야 한다. 따라서 DRM이 유지된 체로 암호화된 파일을 서버로 전송한 후, 서버에서 복호화 모듈을 거치는 로직을 작성해주어 이를 읽을 수 있게 처리해주어야 한다.

따라서 DRM 솔루션을 제공하는 업체의 복호화 모듈 또는 암호화 모듈을 설치해주어야 한다.
파싱 작업을 통해 필요한 정보를 추출하는데 이는 다음과 같다.
1) 파일명
2) 파일 위치(경로)
 

복호화 모듈을 거치기 위해서는 엑셀 파일을 가공하는 부분에 서버에 저장된 파일명을 이용해서 복호화해주고, 이 복호화된 파일이 기존 파일명을 가질 수 있도록 파일명을 교체해주어야 한다.

1점대는 교체 후 원본파일은 지워준다. 2점대는 경로를 맞추면 자동으로 진행된다.

복호화 모듈 처리는 jsp 파일 내에서 추가해준다.

<!-- 2021.08.23 -->